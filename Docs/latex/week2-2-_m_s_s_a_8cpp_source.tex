\doxysection{week2-\/2-\/\+MSSA.cpp}
\label{week2-2-_m_s_s_a_8cpp_source}\index{Week2/Week2-\/2-\/InitializeDirect3D/week2-\/2-\/MSSA.cpp@{Week2/Week2-\/2-\/InitializeDirect3D/week2-\/2-\/MSSA.cpp}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 }
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#include "{}../../Common/d3dApp.h"{}}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include <DirectXColors.h>}}
\DoxyCodeLine{00004 }
\DoxyCodeLine{00005 \textcolor{keyword}{using namespace }DirectX;}
\DoxyCodeLine{00006 }
\DoxyCodeLine{00007 \textcolor{keyword}{class }InitDirect3DApp : \textcolor{keyword}{public} D3DApp}
\DoxyCodeLine{00008 \{}
\DoxyCodeLine{00009 \textcolor{keyword}{public}:}
\DoxyCodeLine{00010     InitDirect3DApp(HINSTANCE hInstance);}
\DoxyCodeLine{00011     \string~InitDirect3DApp();}
\DoxyCodeLine{00012 }
\DoxyCodeLine{00013     \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} Initialize()\textcolor{keyword}{override};}
\DoxyCodeLine{00014 }
\DoxyCodeLine{00015 \textcolor{keyword}{private}:}
\DoxyCodeLine{00016     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} OnResize()\textcolor{keyword}{override};}
\DoxyCodeLine{00017     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Update(\textcolor{keyword}{const} GameTimer\& gt)\textcolor{keyword}{override};}
\DoxyCodeLine{00018     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Draw(\textcolor{keyword}{const} GameTimer\& gt)\textcolor{keyword}{override};}
\DoxyCodeLine{00019 }
\DoxyCodeLine{00020 \};}
\DoxyCodeLine{00021 }
\DoxyCodeLine{00022 }
\DoxyCodeLine{00023 }
\DoxyCodeLine{00024 \textcolor{preprocessor}{\#pragma region step1}}
\DoxyCodeLine{00025 \textcolor{comment}{//WinMain -\/-\/> every win32 application needs a WinMain() function, like console application needs main()}}
\DoxyCodeLine{00026 \textcolor{comment}{//HINSTANCE, PSTR.. are part of <Windows.h>}}
\DoxyCodeLine{00027 \textcolor{comment}{//Windows is about Windows (window class that you register and instance of the class) and Messages}}
\DoxyCodeLine{00028 \textcolor{comment}{//cmdLine receives the parameter that somebody passes}}
\DoxyCodeLine{00029 \textcolor{preprocessor}{\#pragma endregion}}
\DoxyCodeLine{00030 }
\DoxyCodeLine{00031 }
\DoxyCodeLine{00032 \textcolor{keywordtype}{int} WINAPI WinMain(HINSTANCE hInstance, HINSTANCE prevInstance,}
\DoxyCodeLine{00033                    PSTR cmdLine, \textcolor{keywordtype}{int} showCmd)}
\DoxyCodeLine{00034 \{}
\DoxyCodeLine{00035     \textcolor{comment}{// Enable run-\/time memory check for debug builds.}}
\DoxyCodeLine{00036 \textcolor{preprocessor}{\#if defined(DEBUG) | defined(\_DEBUG)}}
\DoxyCodeLine{00037     \_CrtSetDbgFlag( \_CRTDBG\_ALLOC\_MEM\_DF | \_CRTDBG\_LEAK\_CHECK\_DF );}
\DoxyCodeLine{00038 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00039 }
\DoxyCodeLine{00040     \textcolor{keywordflow}{try}}
\DoxyCodeLine{00041     \{}
\DoxyCodeLine{00042         InitDirect3DApp theApp(hInstance);}
\DoxyCodeLine{00043         \textcolor{keywordflow}{if}(!theApp.Initialize())}
\DoxyCodeLine{00044             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00045 }
\DoxyCodeLine{00046         \textcolor{keywordflow}{return} theApp.Run();}
\DoxyCodeLine{00047     \}}
\DoxyCodeLine{00048     \textcolor{keywordflow}{catch}(DxException\& e)}
\DoxyCodeLine{00049     \{}
\DoxyCodeLine{00050         MessageBox(\textcolor{keyword}{nullptr}, e.ToString().c\_str(), L\textcolor{stringliteral}{"{}HR Failed"{}}, MB\_OK);}
\DoxyCodeLine{00051         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00052     \}}
\DoxyCodeLine{00053 \}}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055 InitDirect3DApp::InitDirect3DApp(HINSTANCE hInstance)}
\DoxyCodeLine{00056 : D3DApp(hInstance) }
\DoxyCodeLine{00057 \{}
\DoxyCodeLine{00058 }
\DoxyCodeLine{00059 \}}
\DoxyCodeLine{00060 }
\DoxyCodeLine{00061 InitDirect3DApp::\string~InitDirect3DApp()}
\DoxyCodeLine{00062 \{}
\DoxyCodeLine{00063 \}}
\DoxyCodeLine{00064 }
\DoxyCodeLine{00065 \textcolor{keywordtype}{bool} InitDirect3DApp::Initialize()}
\DoxyCodeLine{00066 \{}
\DoxyCodeLine{00067     \textcolor{keywordflow}{if}(!D3DApp::Initialize())}
\DoxyCodeLine{00068         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070     \textcolor{comment}{//step1}}
\DoxyCodeLine{00071     \textcolor{comment}{//We can query the number of quality levels for a given texture format and sample count using the ID3D12Device::CheckFeatureSupport method like so :}}
\DoxyCodeLine{00072     D3D12\_FEATURE\_DATA\_MULTISAMPLE\_QUALITY\_LEVELS msQualityLevels;}
\DoxyCodeLine{00073     msQualityLevels.Format = mBackBufferFormat;}
\DoxyCodeLine{00074     msQualityLevels.SampleCount = 4;}
\DoxyCodeLine{00075     msQualityLevels.Flags = D3D12\_MULTISAMPLE\_QUALITY\_LEVELS\_FLAG\_NONE;}
\DoxyCodeLine{00076     msQualityLevels.NumQualityLevels = 0;}
\DoxyCodeLine{00077 }
\DoxyCodeLine{00078     \textcolor{comment}{//Note that the second parameter is both an input and output parameter. For the input,}}
\DoxyCodeLine{00079     \textcolor{comment}{//we must specify the texture format, sample count, and flag we want to query}}
\DoxyCodeLine{00080     \textcolor{comment}{//multisampling support for.The function will then fill out the quality level as the output.}}
\DoxyCodeLine{00081     \textcolor{comment}{//Valid quality levels for a texture format and sample count combination range from zero to NumQualityLevels–1.}}
\DoxyCodeLine{00082     \textcolor{comment}{//The maximum number of samples that can be taken per pixel is defined by : \#define D3D12\_MAX\_MULTISAMPLE\_SAMPLE\_COUNT ( 32 )}}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084     ThrowIfFailed(md3dDevice-\/>CheckFeatureSupport(D3D12\_FEATURE\_MULTISAMPLE\_QUALITY\_LEVELS, \&msQualityLevels, \textcolor{keyword}{sizeof}(msQualityLevels)));}
\DoxyCodeLine{00085         }
\DoxyCodeLine{00086     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00087 \}}
\DoxyCodeLine{00088 }
\DoxyCodeLine{00089 \textcolor{keywordtype}{void} InitDirect3DApp::OnResize()}
\DoxyCodeLine{00090 \{}
\DoxyCodeLine{00091     D3DApp::OnResize();}
\DoxyCodeLine{00092 \}}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094 \textcolor{keywordtype}{void} InitDirect3DApp::Update(\textcolor{keyword}{const} GameTimer\& gt)}
\DoxyCodeLine{00095 \{}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097 \}}
\DoxyCodeLine{00098 }
\DoxyCodeLine{00099 }
\DoxyCodeLine{00100 }
\DoxyCodeLine{00101 \textcolor{keywordtype}{void} InitDirect3DApp::Draw(\textcolor{keyword}{const} GameTimer\& gt)}
\DoxyCodeLine{00102 \{}
\DoxyCodeLine{00103     \textcolor{comment}{// Reuse the memory associated with command recording.}}
\DoxyCodeLine{00104     \textcolor{comment}{// We can only reset when the associated command lists have finished execution on the GPU.}}
\DoxyCodeLine{00105     ThrowIfFailed(mDirectCmdListAlloc-\/>Reset());}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107     \textcolor{comment}{// A command list can be reset after it has been added to the command queue via ExecuteCommandList.}}
\DoxyCodeLine{00108     \textcolor{comment}{// Reusing the command list reuses memory.}}
\DoxyCodeLine{00109     ThrowIfFailed(mCommandList-\/>Reset(mDirectCmdListAlloc.Get(), \textcolor{keyword}{nullptr}));}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111     \textcolor{comment}{// Indicate a state transition on the resource usage.}}
\DoxyCodeLine{00112     mCommandList-\/>ResourceBarrier(1, \&CD3DX12\_RESOURCE\_BARRIER::Transition(CurrentBackBuffer(),}
\DoxyCodeLine{00113         D3D12\_RESOURCE\_STATE\_PRESENT, D3D12\_RESOURCE\_STATE\_RENDER\_TARGET));}
\DoxyCodeLine{00114 }
\DoxyCodeLine{00115     \textcolor{comment}{// Set the viewport and scissor rect.  This needs to be reset whenever the command list is reset.}}
\DoxyCodeLine{00116     mCommandList-\/>RSSetViewports(1, \&mScreenViewport);}
\DoxyCodeLine{00117     mCommandList-\/>RSSetScissorRects(1, \&mScissorRect);}
\DoxyCodeLine{00118 }
\DoxyCodeLine{00119     \textcolor{comment}{// Clear the back buffer and depth buffer.}}
\DoxyCodeLine{00120     \textcolor{comment}{//mCommandList-\/>ClearRenderTargetView(CurrentBackBufferView(), Colors::LightSteelBlue, 0, nullptr);}}
\DoxyCodeLine{00121     \textcolor{comment}{//Hooman Step1:}}
\DoxyCodeLine{00122     \textcolor{keyword}{const} \textcolor{keywordtype}{float} color[] = \{ 1.0,1.0,0.0,1.0 \};}
\DoxyCodeLine{00123     \textcolor{keyword}{const} \textcolor{keywordtype}{float} c = sin(mTimer.TotalTime());}
\DoxyCodeLine{00124     \textcolor{keyword}{const} \textcolor{keywordtype}{float} color2[] = \{ c,c,1.0,1.0 \};}
\DoxyCodeLine{00125     mCommandList-\/>ClearRenderTargetView(CurrentBackBufferView(), color2, 0, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00126 }
\DoxyCodeLine{00127     mCommandList-\/>ClearDepthStencilView(DepthStencilView(), D3D12\_CLEAR\_FLAG\_DEPTH | D3D12\_CLEAR\_FLAG\_STENCIL, 1.0f, 0, 0, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00128     }
\DoxyCodeLine{00129     \textcolor{comment}{// Specify the buffers we are going to render to.}}
\DoxyCodeLine{00130     mCommandList-\/>OMSetRenderTargets(1, \&CurrentBackBufferView(), \textcolor{keyword}{true}, \&DepthStencilView());}
\DoxyCodeLine{00131     }
\DoxyCodeLine{00132     \textcolor{comment}{// Indicate a state transition on the resource usage.}}
\DoxyCodeLine{00133     mCommandList-\/>ResourceBarrier(1, \&CD3DX12\_RESOURCE\_BARRIER::Transition(CurrentBackBuffer(),}
\DoxyCodeLine{00134         D3D12\_RESOURCE\_STATE\_RENDER\_TARGET, D3D12\_RESOURCE\_STATE\_PRESENT));}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136     \textcolor{comment}{// Done recording commands.}}
\DoxyCodeLine{00137     ThrowIfFailed(mCommandList-\/>Close());}
\DoxyCodeLine{00138  }
\DoxyCodeLine{00139     \textcolor{comment}{// Add the command list to the queue for execution.}}
\DoxyCodeLine{00140     ID3D12CommandList* cmdsLists[] = \{ mCommandList.Get() \};}
\DoxyCodeLine{00141     mCommandQueue-\/>ExecuteCommandLists(\_countof(cmdsLists), cmdsLists);}
\DoxyCodeLine{00142     }
\DoxyCodeLine{00143     \textcolor{comment}{// swap the back and front buffers}}
\DoxyCodeLine{00144     ThrowIfFailed(mSwapChain-\/>Present(0, 0));}
\DoxyCodeLine{00145     mCurrBackBuffer = (mCurrBackBuffer + 1) \% SwapChainBufferCount;}
\DoxyCodeLine{00146 }
\DoxyCodeLine{00147     \textcolor{comment}{// Wait until frame commands are complete.  This waiting is inefficient and is}}
\DoxyCodeLine{00148     \textcolor{comment}{// done for simplicity.  Later we will show how to organize our rendering code}}
\DoxyCodeLine{00149     \textcolor{comment}{// so we do not have to wait per frame.}}
\DoxyCodeLine{00150     FlushCommandQueue();}
\DoxyCodeLine{00151 \}}

\end{DoxyCode}
