\doxysection{Win32\+Application.\+cpp}
\label{_week2-6-_hello_01_triangle_2_win32_application_8cpp_source}\index{Week2/Week2-\/6-\/Hello Triangle/Win32Application.cpp@{Week2/Week2-\/6-\/Hello Triangle/Win32Application.cpp}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{//*********************************************************}}
\DoxyCodeLine{00002 \textcolor{comment}{//}}
\DoxyCodeLine{00003 \textcolor{comment}{// Copyright (c) Microsoft. All rights reserved.}}
\DoxyCodeLine{00004 \textcolor{comment}{// This code is licensed under the MIT License (MIT).}}
\DoxyCodeLine{00005 \textcolor{comment}{// THIS CODE IS PROVIDED *AS IS* WITHOUT WARRANTY OF}}
\DoxyCodeLine{00006 \textcolor{comment}{// ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY}}
\DoxyCodeLine{00007 \textcolor{comment}{// IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR}}
\DoxyCodeLine{00008 \textcolor{comment}{// PURPOSE, MERCHANTABILITY, OR NON-\/INFRINGEMENT.}}
\DoxyCodeLine{00009 \textcolor{comment}{//}}
\DoxyCodeLine{00010 \textcolor{comment}{//*********************************************************}}
\DoxyCodeLine{00011 }
\DoxyCodeLine{00012 \textcolor{preprocessor}{\#include "{}stdafx.h"{}}}
\DoxyCodeLine{00013 \textcolor{preprocessor}{\#include "{}Win32Application.h"{}}}
\DoxyCodeLine{00014 }
\DoxyCodeLine{00015 HWND Win32Application::m\_hwnd = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00016 }
\DoxyCodeLine{00017 \textcolor{keywordtype}{int} Win32Application::Run(DXSample* pSample, HINSTANCE hInstance, \textcolor{keywordtype}{int} nCmdShow)}
\DoxyCodeLine{00018 \{}
\DoxyCodeLine{00019     \textcolor{comment}{// Parse the command line parameters}}
\DoxyCodeLine{00020     \textcolor{keywordtype}{int} argc;}
\DoxyCodeLine{00021     LPWSTR* argv = CommandLineToArgvW(GetCommandLineW(), \&argc);}
\DoxyCodeLine{00022     pSample-\/>ParseCommandLineArgs(argv, argc);}
\DoxyCodeLine{00023     LocalFree(argv);}
\DoxyCodeLine{00024 }
\DoxyCodeLine{00025     \textcolor{comment}{// Initialize the window class.}}
\DoxyCodeLine{00026     WNDCLASSEX windowClass = \{ 0 \};}
\DoxyCodeLine{00027     windowClass.cbSize = \textcolor{keyword}{sizeof}(WNDCLASSEX);}
\DoxyCodeLine{00028     windowClass.style = CS\_HREDRAW | CS\_VREDRAW;}
\DoxyCodeLine{00029     windowClass.lpfnWndProc = WindowProc;}
\DoxyCodeLine{00030     windowClass.hInstance = hInstance;}
\DoxyCodeLine{00031     windowClass.hCursor = LoadCursor(NULL, IDC\_ARROW);}
\DoxyCodeLine{00032     windowClass.lpszClassName = L\textcolor{stringliteral}{"{}DXSampleClass"{}};}
\DoxyCodeLine{00033     RegisterClassEx(\&windowClass);}
\DoxyCodeLine{00034 }
\DoxyCodeLine{00035     RECT windowRect = \{ 0, 0, \textcolor{keyword}{static\_cast<}LONG\textcolor{keyword}{>}(pSample-\/>GetWidth()), \textcolor{keyword}{static\_cast<}LONG\textcolor{keyword}{>}(pSample-\/>GetHeight()) \};}
\DoxyCodeLine{00036     AdjustWindowRect(\&windowRect, WS\_OVERLAPPEDWINDOW, FALSE);}
\DoxyCodeLine{00037 }
\DoxyCodeLine{00038     \textcolor{comment}{// Create the window and store a handle to it.}}
\DoxyCodeLine{00039     m\_hwnd = CreateWindow(}
\DoxyCodeLine{00040         windowClass.lpszClassName,}
\DoxyCodeLine{00041         pSample-\/>GetTitle(),}
\DoxyCodeLine{00042         WS\_OVERLAPPEDWINDOW,}
\DoxyCodeLine{00043         CW\_USEDEFAULT,}
\DoxyCodeLine{00044         CW\_USEDEFAULT,}
\DoxyCodeLine{00045         windowRect.right -\/ windowRect.left,}
\DoxyCodeLine{00046         windowRect.bottom -\/ windowRect.top,}
\DoxyCodeLine{00047         \textcolor{keyword}{nullptr},        \textcolor{comment}{// We have no parent window.}}
\DoxyCodeLine{00048         \textcolor{keyword}{nullptr},        \textcolor{comment}{// We aren't using menus.}}
\DoxyCodeLine{00049         hInstance,}
\DoxyCodeLine{00050         pSample);}
\DoxyCodeLine{00051 }
\DoxyCodeLine{00052     \textcolor{comment}{// Initialize the sample. OnInit is defined in each child-\/implementation of DXSample.}}
\DoxyCodeLine{00053     pSample-\/>OnInit();}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055     ShowWindow(m\_hwnd, nCmdShow);}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057     \textcolor{comment}{// Main sample loop.}}
\DoxyCodeLine{00058     MSG msg = \{\};}
\DoxyCodeLine{00059     \textcolor{keywordflow}{while} (msg.message != WM\_QUIT)}
\DoxyCodeLine{00060     \{}
\DoxyCodeLine{00061         \textcolor{comment}{// Process any messages in the queue.}}
\DoxyCodeLine{00062         \textcolor{keywordflow}{if} (PeekMessage(\&msg, NULL, 0, 0, PM\_REMOVE))}
\DoxyCodeLine{00063         \{}
\DoxyCodeLine{00064             TranslateMessage(\&msg);}
\DoxyCodeLine{00065             DispatchMessage(\&msg);}
\DoxyCodeLine{00066         \}}
\DoxyCodeLine{00067     \}}
\DoxyCodeLine{00068 }
\DoxyCodeLine{00069     pSample-\/>OnDestroy();}
\DoxyCodeLine{00070 }
\DoxyCodeLine{00071     \textcolor{comment}{// Return this part of the WM\_QUIT message to Windows.}}
\DoxyCodeLine{00072     \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(msg.wParam);}
\DoxyCodeLine{00073 \}}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075 \textcolor{comment}{// Main message handler for the sample.}}
\DoxyCodeLine{00076 LRESULT CALLBACK Win32Application::WindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)}
\DoxyCodeLine{00077 \{}
\DoxyCodeLine{00078     DXSample* pSample = \textcolor{keyword}{reinterpret\_cast<}DXSample*\textcolor{keyword}{>}(GetWindowLongPtr(hWnd, GWLP\_USERDATA));}
\DoxyCodeLine{00079 }
\DoxyCodeLine{00080     \textcolor{keywordflow}{switch} (message)}
\DoxyCodeLine{00081     \{}
\DoxyCodeLine{00082     \textcolor{keywordflow}{case} WM\_CREATE:}
\DoxyCodeLine{00083         \{}
\DoxyCodeLine{00084             \textcolor{comment}{// Save the DXSample* passed in to CreateWindow.}}
\DoxyCodeLine{00085             LPCREATESTRUCT pCreateStruct = \textcolor{keyword}{reinterpret\_cast<}LPCREATESTRUCT\textcolor{keyword}{>}(lParam);}
\DoxyCodeLine{00086             SetWindowLongPtr(hWnd, GWLP\_USERDATA, \textcolor{keyword}{reinterpret\_cast<}LONG\_PTR\textcolor{keyword}{>}(pCreateStruct-\/>lpCreateParams));}
\DoxyCodeLine{00087         \}}
\DoxyCodeLine{00088         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00089 }
\DoxyCodeLine{00090     \textcolor{keywordflow}{case} WM\_KEYDOWN:}
\DoxyCodeLine{00091         \textcolor{keywordflow}{if} (pSample)}
\DoxyCodeLine{00092         \{}
\DoxyCodeLine{00093             pSample-\/>OnKeyDown(\textcolor{keyword}{static\_cast<}UINT8\textcolor{keyword}{>}(wParam));}
\DoxyCodeLine{00094         \}}
\DoxyCodeLine{00095         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097     \textcolor{keywordflow}{case} WM\_KEYUP:}
\DoxyCodeLine{00098         \textcolor{keywordflow}{if} (pSample)}
\DoxyCodeLine{00099         \{}
\DoxyCodeLine{00100             pSample-\/>OnKeyUp(\textcolor{keyword}{static\_cast<}UINT8\textcolor{keyword}{>}(wParam));}
\DoxyCodeLine{00101         \}}
\DoxyCodeLine{00102         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00103 }
\DoxyCodeLine{00104     \textcolor{keywordflow}{case} WM\_PAINT:}
\DoxyCodeLine{00105         \textcolor{keywordflow}{if} (pSample)}
\DoxyCodeLine{00106         \{}
\DoxyCodeLine{00107             pSample-\/>OnUpdate();}
\DoxyCodeLine{00108             pSample-\/>OnRender();}
\DoxyCodeLine{00109         \}}
\DoxyCodeLine{00110         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00111 }
\DoxyCodeLine{00112     \textcolor{keywordflow}{case} WM\_DESTROY:}
\DoxyCodeLine{00113         PostQuitMessage(0);}
\DoxyCodeLine{00114         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00115     \}}
\DoxyCodeLine{00116 }
\DoxyCodeLine{00117     \textcolor{comment}{// Handle any messages the switch statement didn't.}}
\DoxyCodeLine{00118     \textcolor{keywordflow}{return} DefWindowProc(hWnd, message, wParam, lParam);}
\DoxyCodeLine{00119 \}}

\end{DoxyCode}
