\doxysection{Ssao.\+h}
\label{_week15_2_skinned_mesh_2_ssao_8h_source}\index{Week15/SkinnedMesh/Ssao.h@{Week15/SkinnedMesh/Ssao.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00002 \textcolor{comment}{// Ssao.h by Frank Luna (C) 2015 All Rights Reserved.}}
\DoxyCodeLine{00003 \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00004 }
\DoxyCodeLine{00005 \textcolor{preprocessor}{\#ifndef SSAO\_H}}
\DoxyCodeLine{00006 \textcolor{preprocessor}{\#define SSAO\_H}}
\DoxyCodeLine{00007 }
\DoxyCodeLine{00008 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{00009 }
\DoxyCodeLine{00010 \textcolor{preprocessor}{\#include "{}../../Common/d3dUtil.h"{}}}
\DoxyCodeLine{00011 \textcolor{preprocessor}{\#include "{}FrameResource.h"{}}}
\DoxyCodeLine{00012  }
\DoxyCodeLine{00013  }
\DoxyCodeLine{00014 \textcolor{keyword}{class }Ssao}
\DoxyCodeLine{00015 \{}
\DoxyCodeLine{00016 \textcolor{keyword}{public}:}
\DoxyCodeLine{00017 }
\DoxyCodeLine{00018     Ssao(ID3D12Device* device, }
\DoxyCodeLine{00019         ID3D12GraphicsCommandList* cmdList, }
\DoxyCodeLine{00020         UINT width, UINT height);}
\DoxyCodeLine{00021     Ssao(\textcolor{keyword}{const} Ssao\& rhs) = \textcolor{keyword}{delete};}
\DoxyCodeLine{00022     Ssao\& operator=(\textcolor{keyword}{const} Ssao\& rhs) = \textcolor{keyword}{delete};}
\DoxyCodeLine{00023     \string~Ssao() = \textcolor{keywordflow}{default}; }
\DoxyCodeLine{00024 }
\DoxyCodeLine{00025     \textcolor{keyword}{static} \textcolor{keyword}{const} DXGI\_FORMAT AmbientMapFormat = DXGI\_FORMAT\_R16\_UNORM;}
\DoxyCodeLine{00026     \textcolor{keyword}{static} \textcolor{keyword}{const} DXGI\_FORMAT NormalMapFormat = DXGI\_FORMAT\_R16G16B16A16\_FLOAT;}
\DoxyCodeLine{00027 }
\DoxyCodeLine{00028     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MaxBlurRadius = 5;}
\DoxyCodeLine{00029 }
\DoxyCodeLine{00030     UINT SsaoMapWidth()\textcolor{keyword}{const};}
\DoxyCodeLine{00031     UINT SsaoMapHeight()\textcolor{keyword}{const};}
\DoxyCodeLine{00032 }
\DoxyCodeLine{00033     \textcolor{keywordtype}{void} GetOffsetVectors(DirectX::XMFLOAT4 offsets[14]);}
\DoxyCodeLine{00034     std::vector<float> CalcGaussWeights(\textcolor{keywordtype}{float} sigma);}
\DoxyCodeLine{00035 }
\DoxyCodeLine{00036 }
\DoxyCodeLine{00037     ID3D12Resource* NormalMap();}
\DoxyCodeLine{00038     ID3D12Resource* AmbientMap();}
\DoxyCodeLine{00039     }
\DoxyCodeLine{00040     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE NormalMapRtv()\textcolor{keyword}{const};}
\DoxyCodeLine{00041     CD3DX12\_GPU\_DESCRIPTOR\_HANDLE NormalMapSrv()\textcolor{keyword}{const};}
\DoxyCodeLine{00042     CD3DX12\_GPU\_DESCRIPTOR\_HANDLE AmbientMapSrv()\textcolor{keyword}{const};}
\DoxyCodeLine{00043 }
\DoxyCodeLine{00044     \textcolor{keywordtype}{void} BuildDescriptors(}
\DoxyCodeLine{00045         ID3D12Resource* depthStencilBuffer,}
\DoxyCodeLine{00046         CD3DX12\_CPU\_DESCRIPTOR\_HANDLE hCpuSrv,}
\DoxyCodeLine{00047         CD3DX12\_GPU\_DESCRIPTOR\_HANDLE hGpuSrv,}
\DoxyCodeLine{00048         CD3DX12\_CPU\_DESCRIPTOR\_HANDLE hCpuRtv,}
\DoxyCodeLine{00049         UINT cbvSrvUavDescriptorSize,}
\DoxyCodeLine{00050         UINT rtvDescriptorSize);}
\DoxyCodeLine{00051 }
\DoxyCodeLine{00052     \textcolor{keywordtype}{void} RebuildDescriptors(ID3D12Resource* depthStencilBuffer);}
\DoxyCodeLine{00053 }
\DoxyCodeLine{00054     \textcolor{keywordtype}{void} SetPSOs(ID3D12PipelineState* ssaoPso, ID3D12PipelineState* ssaoBlurPso);}
\DoxyCodeLine{00055 }
\DoxyCodeLine{00059     \textcolor{keywordtype}{void} OnResize(UINT newWidth, UINT newHeight);}
\DoxyCodeLine{00060   }
\DoxyCodeLine{00067     \textcolor{keywordtype}{void} ComputeSsao(}
\DoxyCodeLine{00068         ID3D12GraphicsCommandList* cmdList, }
\DoxyCodeLine{00069         FrameResource* currFrame, }
\DoxyCodeLine{00070         \textcolor{keywordtype}{int} blurCount);}
\DoxyCodeLine{00071  }
\DoxyCodeLine{00072 }
\DoxyCodeLine{00073 \textcolor{keyword}{private}:}
\DoxyCodeLine{00074  }
\DoxyCodeLine{00080     \textcolor{keywordtype}{void} BlurAmbientMap(ID3D12GraphicsCommandList* cmdList, FrameResource* currFrame, \textcolor{keywordtype}{int} blurCount);}
\DoxyCodeLine{00081     \textcolor{keywordtype}{void} BlurAmbientMap(ID3D12GraphicsCommandList* cmdList, \textcolor{keywordtype}{bool} horzBlur);}
\DoxyCodeLine{00082 }
\DoxyCodeLine{00083     \textcolor{keywordtype}{void} BuildResources();}
\DoxyCodeLine{00084     \textcolor{keywordtype}{void} BuildRandomVectorTexture(ID3D12GraphicsCommandList* cmdList);}
\DoxyCodeLine{00085  }
\DoxyCodeLine{00086     \textcolor{keywordtype}{void} BuildOffsetVectors();}
\DoxyCodeLine{00087 }
\DoxyCodeLine{00088 }
\DoxyCodeLine{00089 \textcolor{keyword}{private}:}
\DoxyCodeLine{00090     ID3D12Device* md3dDevice;}
\DoxyCodeLine{00091 }
\DoxyCodeLine{00092     Microsoft::WRL::ComPtr<ID3D12RootSignature> mSsaoRootSig;}
\DoxyCodeLine{00093     }
\DoxyCodeLine{00094     ID3D12PipelineState* mSsaoPso = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00095     ID3D12PipelineState* mBlurPso = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00096      }
\DoxyCodeLine{00097     Microsoft::WRL::ComPtr<ID3D12Resource> mRandomVectorMap;}
\DoxyCodeLine{00098     Microsoft::WRL::ComPtr<ID3D12Resource> mRandomVectorMapUploadBuffer;}
\DoxyCodeLine{00099     Microsoft::WRL::ComPtr<ID3D12Resource> mNormalMap;}
\DoxyCodeLine{00100     Microsoft::WRL::ComPtr<ID3D12Resource> mAmbientMap0;}
\DoxyCodeLine{00101     Microsoft::WRL::ComPtr<ID3D12Resource> mAmbientMap1;}
\DoxyCodeLine{00102 }
\DoxyCodeLine{00103     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE mhNormalMapCpuSrv;}
\DoxyCodeLine{00104     CD3DX12\_GPU\_DESCRIPTOR\_HANDLE mhNormalMapGpuSrv;}
\DoxyCodeLine{00105     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE mhNormalMapCpuRtv;}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE mhDepthMapCpuSrv;}
\DoxyCodeLine{00108     CD3DX12\_GPU\_DESCRIPTOR\_HANDLE mhDepthMapGpuSrv;}
\DoxyCodeLine{00109 }
\DoxyCodeLine{00110     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE mhRandomVectorMapCpuSrv;}
\DoxyCodeLine{00111     CD3DX12\_GPU\_DESCRIPTOR\_HANDLE mhRandomVectorMapGpuSrv;}
\DoxyCodeLine{00112 }
\DoxyCodeLine{00113     \textcolor{comment}{// Need two for ping-\/ponging during blur.}}
\DoxyCodeLine{00114     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE mhAmbientMap0CpuSrv;}
\DoxyCodeLine{00115     CD3DX12\_GPU\_DESCRIPTOR\_HANDLE mhAmbientMap0GpuSrv;}
\DoxyCodeLine{00116     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE mhAmbientMap0CpuRtv;}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE mhAmbientMap1CpuSrv;}
\DoxyCodeLine{00119     CD3DX12\_GPU\_DESCRIPTOR\_HANDLE mhAmbientMap1GpuSrv;}
\DoxyCodeLine{00120     CD3DX12\_CPU\_DESCRIPTOR\_HANDLE mhAmbientMap1CpuRtv;}
\DoxyCodeLine{00121 }
\DoxyCodeLine{00122     UINT mRenderTargetWidth;}
\DoxyCodeLine{00123     UINT mRenderTargetHeight;}
\DoxyCodeLine{00124 }
\DoxyCodeLine{00125     DirectX::XMFLOAT4 mOffsets[14];}
\DoxyCodeLine{00126 }
\DoxyCodeLine{00127     D3D12\_VIEWPORT mViewport;}
\DoxyCodeLine{00128     D3D12\_RECT mScissorRect;}
\DoxyCodeLine{00129 \};}
\DoxyCodeLine{00130 }
\DoxyCodeLine{00131 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// SSAO\_H}}

\end{DoxyCode}
